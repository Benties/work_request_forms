{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams,useNavigate,useSearchParams}from'react-router-dom';import{Paper,Typography,TextField,Button,Box,CircularProgress,Alert,Chip,IconButton,Dialog,DialogTitle,DialogContent,DialogActions,ImageList,ImageListItem,ImageListItemBar}from'@mui/material';import{CloudUpload as CloudUploadIcon,Delete as DeleteIcon,Edit as EditIcon,Image as ImageIcon,PictureAsPdf as PdfIcon,Description as DocumentIcon}from'@mui/icons-material';import{api,FIELDS}from'../config/quickbase.ts';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const QuestionForm=()=>{var _getAttachmentFileNam;const{id}=useParams();const[searchParams]=useSearchParams();const userId=searchParams.get('userId');const requestId=searchParams.get('requestId');const formId=searchParams.get('formId');const navigate=useNavigate();const[question,setQuestion]=useState(null);const[answer,setAnswer]=useState(null);const[answerText,setAnswerText]=useState('');const[file,setFile]=useState(null);const[attachments,setAttachments]=useState([]);const[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);const[error,setError]=useState(null);const[success,setSuccess]=useState(false);const[previewOpen,setPreviewOpen]=useState(false);const[selectedAttachment,setSelectedAttachment]=useState(null);const[editingAttachment,setEditingAttachment]=useState(null);useEffect(()=>{const fetchData=async()=>{if(!requestId||!formId||!id){setError('Missing required parameters: requestId, formId, or questionId');setLoading(false);return;}try{// Fetch question\nconst questionResponse=await api.getQuestion(id);setQuestion(questionResponse.data[0]);// Fetch existing answer\nconst answerResponse=await api.getAnswer(id,requestId);if(answerResponse.data&&answerResponse.data.length>0){setAnswer(answerResponse.data[0]);setAnswerText(String(answerResponse.data[0][FIELDS.ANSWERS.ANSWER].value));// Fetch attachments for the answer\nconst attachmentsResponse=await api.getAttachmentsForAnswer(Number(answerResponse.data[0][FIELDS.ANSWERS.RECORD_ID].value));console.log(attachmentsResponse.data);setAttachments(attachmentsResponse.data);}}catch(error){setError('Failed to load data');console.error('Error fetching data:',error);}finally{setLoading(false);}};fetchData();},[id,requestId,formId]);const handlePreviewOpen=attachment=>{setSelectedAttachment(attachment);setPreviewOpen(true);};const handlePreviewClose=()=>{setPreviewOpen(false);setSelectedAttachment(null);};const handleEditAttachment=attachment=>{setEditingAttachment(attachment);};const handleEditFileChange=event=>{if(event.target.files&&event.target.files[0]){setFile(event.target.files[0]);}};const handleUpdateAttachment=async()=>{if(!editingAttachment||!file||!answer){setError('Missing required data for update');return;}try{const answerId=Number(answer[FIELDS.ANSWERS.RECORD_ID].value);const attachmentId=Number(editingAttachment[FIELDS.ATTACHMENTS.RECORD_ID].value);console.log('Updating attachment:',{answerId,fileName:file.name,attachmentId});await api.uploadFileAttachment(answerId,file.name,file,attachmentId);// Refresh attachments\nconst updatedAttachments=await api.getAttachmentsForAnswer(answerId);console.log('Updated attachments:',updatedAttachments.data);setAttachments(updatedAttachments.data);setFile(null);setEditingAttachment(null);}catch(error){setError('Failed to update attachment');console.error('Error updating attachment:',error);}};const getFileIcon=fileName=>{var _fileName$split$pop;if(!fileName)return/*#__PURE__*/_jsx(DocumentIcon,{});const extension=(_fileName$split$pop=fileName.split('.').pop())===null||_fileName$split$pop===void 0?void 0:_fileName$split$pop.toLowerCase();switch(extension){case'jpg':case'jpeg':case'png':case'gif':return/*#__PURE__*/_jsx(ImageIcon,{});case'pdf':return/*#__PURE__*/_jsx(PdfIcon,{});default:return/*#__PURE__*/_jsx(DocumentIcon,{});}};const handleDeleteAttachment=async recordId=>{try{console.log('Deleting attachment:',recordId);await api.deleteAttachment(recordId);setAttachments(attachments.filter(att=>att[FIELDS.ATTACHMENTS.RECORD_ID].value!==recordId));}catch(error){setError('Failed to delete attachment');console.error('Error deleting attachment:',error);}};const getAttachmentFileName=attachment=>{var _attachment$FIELDS$AT,_fileAttachment$versi;const fileAttachment=(_attachment$FIELDS$AT=attachment[FIELDS.ATTACHMENTS.FILE_ATTACHMENT])===null||_attachment$FIELDS$AT===void 0?void 0:_attachment$FIELDS$AT.value;if(typeof fileAttachment==='object'&&(fileAttachment===null||fileAttachment===void 0?void 0:(_fileAttachment$versi=fileAttachment.versions)===null||_fileAttachment$versi===void 0?void 0:_fileAttachment$versi.length)>0){// Get the last version in the array (most recent)\nconst latestVersion=fileAttachment.versions[fileAttachment.versions.length-1];return latestVersion.fileName;}return undefined;};const getAttachmentUrl=attachment=>{var _attachment$;const urlField=(_attachment$=attachment[8])===null||_attachment$===void 0?void 0:_attachment$.value;if(typeof urlField==='string'){return urlField;}return undefined;};const handleAttachmentClick=attachment=>{const url=getAttachmentUrl(attachment);if(url){window.open(url,'_blank');}};const handleSubmit=async event=>{event.preventDefault();if(!userId||!requestId||!formId||!id){setError('Missing required parameters');return;}setSaving(true);setError(null);try{let answerResponse;let answerRecordId;if(answer){// Update existing answer\nanswerResponse=await api.updateAnswer(String(answer[FIELDS.ANSWERS.RECORD_ID].value),answerText,userId,requestId);// For updates, get the record ID from metadata\nanswerRecordId=Number(answer[FIELDS.ANSWERS.RECORD_ID].value);}else{var _answerResponse$data,_answerResponse$data$,_answerResponse$data$2;// Create new answer\nanswerResponse=await api.saveAnswer(id,answerText,userId,requestId);// For new answers, get the record ID from the response data\nanswerRecordId=(_answerResponse$data=answerResponse.data)===null||_answerResponse$data===void 0?void 0:(_answerResponse$data$=_answerResponse$data[0])===null||_answerResponse$data$===void 0?void 0:(_answerResponse$data$2=_answerResponse$data$[FIELDS.ANSWERS.RECORD_ID])===null||_answerResponse$data$2===void 0?void 0:_answerResponse$data$2.value;}if(!answerRecordId){throw new Error('Failed to get answer record ID');}// Upload file if selected\nif(file){await api.uploadFileAttachment(answerRecordId,file.name,file);}setSuccess(true);setTimeout(()=>navigate(`/?userId=${userId}&requestId=${requestId}&formId=${formId}`),2000);}catch(error){setError('Failed to save answer');console.error('Error saving answer:',error);}finally{setSaving(false);}};if(loading){return/*#__PURE__*/_jsx(Box,{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",minHeight:\"200px\",children:/*#__PURE__*/_jsx(CircularProgress,{})});}if(error){return/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error});}if(!question){return/*#__PURE__*/_jsx(Alert,{severity:\"error\",children:\"Question not found\"});}return/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:3},children:[/*#__PURE__*/_jsxs(Box,{display:\"flex\",justifyContent:\"space-between\",alignItems:\"center\",mb:2,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",children:String(question[FIELDS.QUESTIONS.QUESTION].value)}),answer&&/*#__PURE__*/_jsx(Chip,{label:\"Previously Answered\",color:\"success\",variant:\"outlined\"})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,multiline:true,rows:4,variant:\"outlined\",label:\"Your Answer\",value:answerText,onChange:e=>setAnswerText(e.target.value),margin:\"normal\",required:question[FIELDS.QUESTIONS.REQUIRED].value}),/*#__PURE__*/_jsxs(Box,{sx:{mt:2,mb:2},children:[/*#__PURE__*/_jsx(\"input\",{accept:\"image/*\",style:{display:'none'},id:\"file-upload\",type:\"file\",onChange:e=>{if(e.target.files&&e.target.files[0]){setFile(e.target.files[0]);}}}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"file-upload\",children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",component:\"span\",startIcon:/*#__PURE__*/_jsx(CloudUploadIcon,{}),children:\"Upload Attachment\"})}),file&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:1},children:[\"Selected file: \",file.name]})]}),attachments.length>0&&/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",children:\"Attachments:\"}),/*#__PURE__*/_jsx(ImageList,{cols:3,rowHeight:164,children:attachments.map(attachment=>{const fileName=getAttachmentFileName(attachment);return/*#__PURE__*/_jsxs(ImageListItem,{children:[/*#__PURE__*/_jsx(Box,{sx:{width:'100%',height:'100%',display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',bgcolor:'grey.100',cursor:'pointer',position:'relative',overflow:'hidden','&:hover':{'& .overlay':{opacity:1}}},onClick:()=>handleAttachmentClick(attachment),children:fileName!==null&&fileName!==void 0&&fileName.match(/\\.(jpg|jpeg|png|gif)$/i)?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{src:getAttachmentUrl(attachment),alt:fileName,style:{width:'100%',height:'100%',objectFit:'contain',padding:'8px'}}),/*#__PURE__*/_jsx(Box,{className:\"overlay\",sx:{position:'absolute',top:0,left:0,right:0,bottom:0,bgcolor:'rgba(0, 0, 0, 0.5)',display:'flex',alignItems:'center',justifyContent:'center',opacity:0,transition:'opacity 0.2s'},children:/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{color:'white',textAlign:'center',px:2},children:\"Click to view\"})})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[getFileIcon(fileName),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",sx:{mt:1,textAlign:'center',px:1},children:fileName||'Unknown File'})]})}),/*#__PURE__*/_jsx(ImageListItemBar,{position:\"top\",actionIcon:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:e=>{e.stopPropagation();handleEditAttachment(attachment);},children:/*#__PURE__*/_jsx(EditIcon,{})}),/*#__PURE__*/_jsx(IconButton,{size:\"small\",onClick:e=>{e.stopPropagation();handleDeleteAttachment(Number(attachment[FIELDS.ATTACHMENTS.RECORD_ID].value));},children:/*#__PURE__*/_jsx(DeleteIcon,{})})]})})]},Number(attachment[FIELDS.ATTACHMENTS.RECORD_ID].value));})})]}),/*#__PURE__*/_jsxs(Dialog,{open:previewOpen,onClose:handlePreviewClose,maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:selectedAttachment&&getAttachmentFileName(selectedAttachment)||'Preview'}),/*#__PURE__*/_jsx(DialogContent,{children:selectedAttachment&&/*#__PURE__*/_jsx(Box,{sx:{width:'100%',height:'100%',display:'flex',justifyContent:'center'},children:(_getAttachmentFileNam=getAttachmentFileName(selectedAttachment))!==null&&_getAttachmentFileNam!==void 0&&_getAttachmentFileNam.match(/\\.(jpg|jpeg|png|gif)$/i)?/*#__PURE__*/_jsx(\"img\",{src:getAttachmentUrl(selectedAttachment),alt:getAttachmentFileName(selectedAttachment)||'Image',style:{maxWidth:'100%',maxHeight:'70vh'}}):/*#__PURE__*/_jsx(Box,{sx:{p:2,textAlign:'center'},children:/*#__PURE__*/_jsxs(Typography,{children:[\"Preview not available for this file type.\",/*#__PURE__*/_jsx(\"br\",{}),\"File name: \",getAttachmentFileName(selectedAttachment)||'Unknown File']})})})}),/*#__PURE__*/_jsx(DialogActions,{children:/*#__PURE__*/_jsx(Button,{onClick:handlePreviewClose,children:\"Close\"})})]}),/*#__PURE__*/_jsxs(Dialog,{open:!!editingAttachment,onClose:()=>setEditingAttachment(null),children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Edit Attachment\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsx(\"input\",{accept:\"*/*\",style:{display:'none'},id:\"edit-file-upload\",type:\"file\",onChange:handleEditFileChange}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"edit-file-upload\",children:/*#__PURE__*/_jsx(Button,{variant:\"outlined\",component:\"span\",startIcon:/*#__PURE__*/_jsx(CloudUploadIcon,{}),children:\"Select New File\"})}),file&&/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",sx:{mt:1},children:[\"Selected file: \",file.name]})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setEditingAttachment(null),children:\"Cancel\"}),/*#__PURE__*/_jsx(Button,{onClick:handleUpdateAttachment,variant:\"contained\",disabled:!file,children:\"Update\"})]})]}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),success&&/*#__PURE__*/_jsx(Alert,{severity:\"success\",sx:{mb:2},children:\"Answer saved successfully!\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"contained\",color:\"primary\",disabled:saving,children:saving?/*#__PURE__*/_jsx(CircularProgress,{size:24}):answer?'Update Answer':'Save Answer'})]})]});};export default QuestionForm;","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","useSearchParams","Paper","Typography","TextField","Button","Box","CircularProgress","Alert","Chip","IconButton","Dialog","DialogTitle","DialogContent","DialogActions","ImageList","ImageListItem","ImageListItemBar","CloudUpload","CloudUploadIcon","Delete","DeleteIcon","Edit","EditIcon","Image","ImageIcon","PictureAsPdf","PdfIcon","Description","DocumentIcon","api","FIELDS","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","QuestionForm","_getAttachmentFileNam","id","searchParams","userId","get","requestId","formId","navigate","question","setQuestion","answer","setAnswer","answerText","setAnswerText","file","setFile","attachments","setAttachments","loading","setLoading","saving","setSaving","error","setError","success","setSuccess","previewOpen","setPreviewOpen","selectedAttachment","setSelectedAttachment","editingAttachment","setEditingAttachment","fetchData","questionResponse","getQuestion","data","answerResponse","getAnswer","length","String","ANSWERS","ANSWER","value","attachmentsResponse","getAttachmentsForAnswer","Number","RECORD_ID","console","log","handlePreviewOpen","attachment","handlePreviewClose","handleEditAttachment","handleEditFileChange","event","target","files","handleUpdateAttachment","answerId","attachmentId","ATTACHMENTS","fileName","name","uploadFileAttachment","updatedAttachments","getFileIcon","_fileName$split$pop","extension","split","pop","toLowerCase","handleDeleteAttachment","recordId","deleteAttachment","filter","att","getAttachmentFileName","_attachment$FIELDS$AT","_fileAttachment$versi","fileAttachment","FILE_ATTACHMENT","versions","latestVersion","undefined","getAttachmentUrl","_attachment$","urlField","handleAttachmentClick","url","window","open","handleSubmit","preventDefault","answerRecordId","updateAnswer","_answerResponse$data","_answerResponse$data$","_answerResponse$data$2","saveAnswer","Error","setTimeout","display","justifyContent","alignItems","minHeight","children","severity","sx","mb","elevation","p","variant","QUESTIONS","QUESTION","label","color","onSubmit","fullWidth","multiline","rows","onChange","e","margin","required","REQUIRED","mt","accept","style","type","htmlFor","component","startIcon","cols","rowHeight","map","width","height","flexDirection","bgcolor","cursor","position","overflow","opacity","onClick","match","src","alt","objectFit","padding","className","top","left","right","bottom","transition","textAlign","px","actionIcon","size","stopPropagation","onClose","maxWidth","maxHeight","disabled"],"sources":["/home/ben/lighthouse/work_requsts/frontend/src/components/QuestionForm.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useParams, useNavigate, useSearchParams } from 'react-router-dom';\nimport {\n  Paper,\n  Typography,\n  TextField,\n  Button,\n  Box,\n  CircularProgress,\n  Alert,\n  Chip,\n  List,\n  ListItem,\n  ListItemText,\n  IconButton,\n  Dialog,\n  DialogTitle,\n  DialogContent,\n  DialogActions,\n  ImageList,\n  ImageListItem,\n  ImageListItemBar\n} from '@mui/material';\nimport {\n  CloudUpload as CloudUploadIcon,\n  Delete as DeleteIcon,\n  Edit as EditIcon,\n  Image as ImageIcon,\n  PictureAsPdf as PdfIcon,\n  Description as DocumentIcon\n} from '@mui/icons-material';\nimport { api, FIELDS } from '../config/quickbase.ts';\n\ninterface QuickBaseField {\n  value: string | boolean;\n}\n\ninterface Question {\n  [key: number]: QuickBaseField;\n}\n\ninterface Answer {\n  [key: number]: QuickBaseField;\n}\n\ninterface Attachment {\n  record_id: number;\n  [key: number]: {\n    value: number | {\n      url: string;\n      versions: Array<{\n        creator: {\n          email: string;\n          id: string;\n          name: string;\n          userName: string;\n        };\n        fileName: string;\n        uploaded: string;\n        versionNumber: number;\n      }>;\n    };\n  };\n}\n\nconst QuestionForm = () => {\n  const { id } = useParams<{ id: string }>();\n  const [searchParams] = useSearchParams();\n  const userId = searchParams.get('userId');\n  const requestId = searchParams.get('requestId');\n  const formId = searchParams.get('formId');\n  const navigate = useNavigate();\n  const [question, setQuestion] = useState<Question | null>(null);\n  const [answer, setAnswer] = useState<Answer | null>(null);\n  const [answerText, setAnswerText] = useState('');\n  const [file, setFile] = useState<File | null>(null);\n  const [attachments, setAttachments] = useState<Attachment[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [success, setSuccess] = useState(false);\n  const [previewOpen, setPreviewOpen] = useState(false);\n  const [selectedAttachment, setSelectedAttachment] = useState<Attachment | null>(null);\n  const [editingAttachment, setEditingAttachment] = useState<Attachment | null>(null);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      if (!requestId || !formId || !id) {\n        setError('Missing required parameters: requestId, formId, or questionId');\n        setLoading(false);\n        return;\n      }\n\n      try {\n        // Fetch question\n        const questionResponse = await api.getQuestion(id);\n        setQuestion(questionResponse.data[0]);\n\n        // Fetch existing answer\n        const answerResponse = await api.getAnswer(id, requestId);\n        if (answerResponse.data && answerResponse.data.length > 0) {\n          setAnswer(answerResponse.data[0]);\n          setAnswerText(String(answerResponse.data[0][FIELDS.ANSWERS.ANSWER].value));\n\n          // Fetch attachments for the answer\n          const attachmentsResponse = await api.getAttachmentsForAnswer(\n            Number(answerResponse.data[0][FIELDS.ANSWERS.RECORD_ID].value)\n          );\n          console.log(attachmentsResponse.data);\n          setAttachments(attachmentsResponse.data);\n        }\n      } catch (error) {\n        setError('Failed to load data');\n        console.error('Error fetching data:', error);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchData();\n  }, [id, requestId, formId]);\n\n  const handlePreviewOpen = (attachment: Attachment) => {\n    setSelectedAttachment(attachment);\n    setPreviewOpen(true);\n  };\n\n  const handlePreviewClose = () => {\n    setPreviewOpen(false);\n    setSelectedAttachment(null);\n  };\n\n  const handleEditAttachment = (attachment: Attachment) => {\n    setEditingAttachment(attachment);\n  };\n\n  const handleEditFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n    if (event.target.files && event.target.files[0]) {\n      setFile(event.target.files[0]);\n    }\n  };\n\n  const handleUpdateAttachment = async () => {\n    if (!editingAttachment || !file || !answer) {\n      setError('Missing required data for update');\n      return;\n    }\n\n    try {\n      const answerId = Number(answer[FIELDS.ANSWERS.RECORD_ID].value);\n      const attachmentId = Number(editingAttachment[FIELDS.ATTACHMENTS.RECORD_ID].value);\n\n      console.log('Updating attachment:', {\n        answerId,\n        fileName: file.name,\n        attachmentId\n      });\n\n      await api.uploadFileAttachment(\n        answerId,\n        file.name,\n        file,\n        attachmentId\n      );\n\n      // Refresh attachments\n      const updatedAttachments = await api.getAttachmentsForAnswer(answerId);\n      console.log('Updated attachments:', updatedAttachments.data);\n      setAttachments(updatedAttachments.data);\n      setFile(null);\n      setEditingAttachment(null);\n    } catch (error) {\n      setError('Failed to update attachment');\n      console.error('Error updating attachment:', error);\n    }\n  };\n\n  const getFileIcon = (fileName: string | undefined) => {\n    if (!fileName) return <DocumentIcon />;\n\n    const extension = fileName.split('.').pop()?.toLowerCase();\n    switch (extension) {\n      case 'jpg':\n      case 'jpeg':\n      case 'png':\n      case 'gif':\n        return <ImageIcon />;\n      case 'pdf':\n        return <PdfIcon />;\n      default:\n        return <DocumentIcon />;\n    }\n  };\n\n  const handleDeleteAttachment = async (recordId: number) => {\n    try {\n      console.log('Deleting attachment:', recordId);\n      await api.deleteAttachment(recordId);\n      setAttachments(attachments.filter(att => att[FIELDS.ATTACHMENTS.RECORD_ID].value !== recordId));\n    } catch (error) {\n      setError('Failed to delete attachment');\n      console.error('Error deleting attachment:', error);\n    }\n  };\n\n  const getAttachmentFileName = (attachment: Attachment) => {\n    const fileAttachment = attachment[FIELDS.ATTACHMENTS.FILE_ATTACHMENT]?.value;\n    if (typeof fileAttachment === 'object' && fileAttachment?.versions?.length > 0) {\n      // Get the last version in the array (most recent)\n      const latestVersion = fileAttachment.versions[fileAttachment.versions.length - 1];\n      return latestVersion.fileName;\n    }\n    return undefined;\n  };\n\n  const getAttachmentUrl = (attachment: Attachment) => {\n    const urlField = attachment[8]?.value;\n    if (typeof urlField === 'string') {\n      return urlField;\n    }\n    return undefined;\n  };\n\n  const handleAttachmentClick = (attachment: Attachment) => {\n    const url = getAttachmentUrl(attachment);\n    if (url) {\n      window.open(url, '_blank');\n    }\n  };\n\n  const handleSubmit = async (event: React.FormEvent) => {\n    event.preventDefault();\n    if (!userId || !requestId || !formId || !id) {\n      setError('Missing required parameters');\n      return;\n    }\n\n    setSaving(true);\n    setError(null);\n\n    try {\n      let answerResponse;\n      let answerRecordId: number;\n\n      if (answer) {\n        // Update existing answer\n        answerResponse = await api.updateAnswer(\n          String(answer[FIELDS.ANSWERS.RECORD_ID].value),\n          answerText,\n          userId,\n          requestId\n        );\n        // For updates, get the record ID from metadata\n        answerRecordId = Number(answer[FIELDS.ANSWERS.RECORD_ID].value);\n      } else {\n        // Create new answer\n        answerResponse = await api.saveAnswer(\n          id,\n          answerText,\n          userId,\n          requestId\n        );\n        // For new answers, get the record ID from the response data\n        answerRecordId = answerResponse.data?.[0]?.[FIELDS.ANSWERS.RECORD_ID]?.value;\n      }\n\n      if (!answerRecordId) {\n        throw new Error('Failed to get answer record ID');\n      }\n\n      // Upload file if selected\n      if (file) {\n        await api.uploadFileAttachment(\n          answerRecordId,\n          file.name,\n          file\n        );\n      }\n\n      setSuccess(true);\n      setTimeout(() => navigate(`/?userId=${userId}&requestId=${requestId}&formId=${formId}`), 2000);\n    } catch (error) {\n      setError('Failed to save answer');\n      console.error('Error saving answer:', error);\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" minHeight=\"200px\">\n        <CircularProgress />\n      </Box>\n    );\n  }\n\n  if (error) {\n    return (\n      <Alert severity=\"error\" sx={{ mb: 2 }}>\n        {error}\n      </Alert>\n    );\n  }\n\n  if (!question) {\n    return (\n      <Alert severity=\"error\">\n        Question not found\n      </Alert>\n    );\n  }\n\n  return (\n    <Paper elevation={3} sx={{ p: 3 }}>\n      <Box display=\"flex\" justifyContent=\"space-between\" alignItems=\"center\" mb={2}>\n        <Typography variant=\"h5\">\n          {String(question[FIELDS.QUESTIONS.QUESTION].value)}\n        </Typography>\n        {answer && (\n          <Chip\n            label=\"Previously Answered\"\n            color=\"success\"\n            variant=\"outlined\"\n          />\n        )}\n      </Box>\n      <form onSubmit={handleSubmit}>\n        <TextField\n          fullWidth\n          multiline\n          rows={4}\n          variant=\"outlined\"\n          label=\"Your Answer\"\n          value={answerText}\n          onChange={(e) => setAnswerText(e.target.value)}\n          margin=\"normal\"\n          required={question[FIELDS.QUESTIONS.REQUIRED].value as boolean}\n        />\n        <Box sx={{ mt: 2, mb: 2 }}>\n          <input\n            accept=\"image/*\"\n            style={{ display: 'none' }}\n            id=\"file-upload\"\n            type=\"file\"\n            onChange={(e) => {\n              if (e.target.files && e.target.files[0]) {\n                setFile(e.target.files[0]);\n              }\n            }}\n          />\n          <label htmlFor=\"file-upload\">\n            <Button\n              variant=\"outlined\"\n              component=\"span\"\n              startIcon={<CloudUploadIcon />}\n            >\n              Upload Attachment\n            </Button>\n          </label>\n          {file && (\n            <Typography variant=\"body2\" sx={{ mt: 1 }}>\n              Selected file: {file.name}\n            </Typography>\n          )}\n        </Box>\n\n        {attachments.length > 0 && (\n          <Box sx={{ mt: 2 }}>\n            <Typography variant=\"subtitle1\">Attachments:</Typography>\n            <ImageList cols={3} rowHeight={164}>\n              {attachments.map((attachment) => {\n                const fileName = getAttachmentFileName(attachment);\n                return (\n                  <ImageListItem key={Number(attachment[FIELDS.ATTACHMENTS.RECORD_ID].value)}>\n                    <Box\n                      sx={{\n                        width: '100%',\n                        height: '100%',\n                        display: 'flex',\n                        flexDirection: 'column',\n                        alignItems: 'center',\n                        justifyContent: 'center',\n                        bgcolor: 'grey.100',\n                        cursor: 'pointer',\n                        position: 'relative',\n                        overflow: 'hidden',\n                        '&:hover': {\n                          '& .overlay': {\n                            opacity: 1,\n                          },\n                        },\n                      }}\n                      onClick={() => handleAttachmentClick(attachment)}\n                    >\n                      {fileName?.match(/\\.(jpg|jpeg|png|gif)$/i) ? (\n                        <>\n                          <img\n                            src={getAttachmentUrl(attachment)}\n                            alt={fileName}\n                            style={{\n                              width: '100%',\n                              height: '100%',\n                              objectFit: 'contain',\n                              padding: '8px'\n                            }}\n                          />\n                          <Box\n                            className=\"overlay\"\n                            sx={{\n                              position: 'absolute',\n                              top: 0,\n                              left: 0,\n                              right: 0,\n                              bottom: 0,\n                              bgcolor: 'rgba(0, 0, 0, 0.5)',\n                              display: 'flex',\n                              alignItems: 'center',\n                              justifyContent: 'center',\n                              opacity: 0,\n                              transition: 'opacity 0.2s',\n                            }}\n                          >\n                            <Typography\n                              variant=\"body2\"\n                              sx={{\n                                color: 'white',\n                                textAlign: 'center',\n                                px: 2\n                              }}\n                            >\n                              Click to view\n                            </Typography>\n                          </Box>\n                        </>\n                      ) : (\n                        <>\n                          {getFileIcon(fileName)}\n                          <Typography variant=\"body2\" sx={{ mt: 1, textAlign: 'center', px: 1 }}>\n                            {fileName || 'Unknown File'}\n                          </Typography>\n                        </>\n                      )}\n                    </Box>\n                    <ImageListItemBar\n                      position=\"top\"\n                      actionIcon={\n                        <Box>\n                          <IconButton\n                            size=\"small\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleEditAttachment(attachment);\n                            }}\n                          >\n                            <EditIcon />\n                          </IconButton>\n                          <IconButton\n                            size=\"small\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              handleDeleteAttachment(Number(attachment[FIELDS.ATTACHMENTS.RECORD_ID].value));\n                            }}\n                          >\n                            <DeleteIcon />\n                          </IconButton>\n                        </Box>\n                      }\n                    />\n                  </ImageListItem>\n                );\n              })}\n            </ImageList>\n          </Box>\n        )}\n\n        {/* Preview Dialog */}\n        <Dialog\n          open={previewOpen}\n          onClose={handlePreviewClose}\n          maxWidth=\"md\"\n          fullWidth\n        >\n          <DialogTitle>\n            {selectedAttachment && getAttachmentFileName(selectedAttachment) || 'Preview'}\n          </DialogTitle>\n          <DialogContent>\n            {selectedAttachment && (\n              <Box sx={{ width: '100%', height: '100%', display: 'flex', justifyContent: 'center' }}>\n                {getAttachmentFileName(selectedAttachment)?.match(/\\.(jpg|jpeg|png|gif)$/i) ? (\n                  <img\n                    src={getAttachmentUrl(selectedAttachment)}\n                    alt={getAttachmentFileName(selectedAttachment) || 'Image'}\n                    style={{ maxWidth: '100%', maxHeight: '70vh' }}\n                  />\n                ) : (\n                  <Box sx={{ p: 2, textAlign: 'center' }}>\n                    <Typography>\n                      Preview not available for this file type.\n                      <br />\n                      File name: {getAttachmentFileName(selectedAttachment) || 'Unknown File'}\n                    </Typography>\n                  </Box>\n                )}\n              </Box>\n            )}\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={handlePreviewClose}>Close</Button>\n          </DialogActions>\n        </Dialog>\n\n        {/* Edit Attachment Dialog */}\n        <Dialog\n          open={!!editingAttachment}\n          onClose={() => setEditingAttachment(null)}\n        >\n          <DialogTitle>Edit Attachment</DialogTitle>\n          <DialogContent>\n            <Box sx={{ mt: 2 }}>\n              <input\n                accept=\"*/*\"\n                style={{ display: 'none' }}\n                id=\"edit-file-upload\"\n                type=\"file\"\n                onChange={handleEditFileChange}\n              />\n              <label htmlFor=\"edit-file-upload\">\n                <Button\n                  variant=\"outlined\"\n                  component=\"span\"\n                  startIcon={<CloudUploadIcon />}\n                >\n                  Select New File\n                </Button>\n              </label>\n              {file && (\n                <Typography variant=\"body2\" sx={{ mt: 1 }}>\n                  Selected file: {file.name}\n                </Typography>\n              )}\n            </Box>\n          </DialogContent>\n          <DialogActions>\n            <Button onClick={() => setEditingAttachment(null)}>Cancel</Button>\n            <Button\n              onClick={handleUpdateAttachment}\n              variant=\"contained\"\n              disabled={!file}\n            >\n              Update\n            </Button>\n          </DialogActions>\n        </Dialog>\n\n        {error && (\n          <Alert severity=\"error\" sx={{ mb: 2 }}>\n            {error}\n          </Alert>\n        )}\n        {success && (\n          <Alert severity=\"success\" sx={{ mb: 2 }}>\n            Answer saved successfully!\n          </Alert>\n        )}\n        <Button\n          type=\"submit\"\n          variant=\"contained\"\n          color=\"primary\"\n          disabled={saving}\n        >\n          {saving ? <CircularProgress size={24} /> : answer ? 'Update Answer' : 'Save Answer'}\n        </Button>\n      </form>\n    </Paper>\n  );\n};\n\nexport default QuestionForm;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}